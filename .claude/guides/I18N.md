# Internationalization (i18n) Guide

## Library: next-intl

- **Default Choice:** Use `next-intl` for Next.js projects (App Router compatible)
- **Fallback:** Use `react-i18next` for non-Next.js React projects

---

## Project Structure

```
/messages
  /en.json
  /es.json
  /fr.json
/app
  /[locale]
    /page.tsx
    /layout.tsx
```

---

## Setup

```typescript
// i18n.ts
import { getRequestConfig } from 'next-intl/server';

export default getRequestConfig(async ({ locale }) => ({
  messages: (await import(`./messages/${locale}.json`)).default
}));

// middleware.ts
import createMiddleware from 'next-intl/middleware';

export default createMiddleware({
  locales: ['en', 'es', 'fr'],
  defaultLocale: 'en',
  localePrefix: 'always' // or 'as-needed'
});

export const config = {
  matcher: ['/((?!api|_next|.*\\..*).*)']
};
```

---

## Translation Files

```json
// messages/en.json
{
  "common": {
    "welcome": "Welcome",
    "submit": "Submit",
    "cancel": "Cancel"
  },
  "navigation": {
    "home": "Home",
    "about": "About",
    "contact": "Contact"
  },
  "errors": {
    "required": "{field} is required",
    "invalid_email": "Invalid email address"
  }
}
```

---

## Usage

```typescript
import { useTranslations } from 'next-intl';

export default function Page() {
  const t = useTranslations('common');
  
  return (
    <div>
      <h1>{t('welcome')}</h1>
      <button>{t('submit')}</button>
    </div>
  );
}

// With interpolation
const t = useTranslations('errors');
<p>{t('required', { field: 'Email' })}</p> // Output: "Email is required"
```

---

## Date & Number Formatting

```typescript
import { useFormatter } from 'next-intl';

export default function Component() {
  const format = useFormatter();
  
  return (
    <div>
      {/* Date formatting */}
      <p>{format.dateTime(new Date(), { dateStyle: 'long' })}</p>
      
      {/* Number formatting */}
      <p>{format.number(1234.56, { style: 'currency', currency: 'USD' })}</p>
      
      {/* Relative time */}
      <p>{format.relativeTime(new Date('2024-01-01'))}</p>
    </div>
  );
}
```

---

## Best Practices

- **Keys in English:** Use English keys for readability in code
- **Nested Structure:** Organize by feature/component, not by language
- **Pluralization:** Use ICU message syntax for plurals
- **Context:** Provide translator context in comments for ambiguous strings

```json
// Good: Organized by feature
{
  "auth": {
    "login": "Log in",
    "logout": "Log out",
    "register": "Sign up"
  }
}

// Pluralization with ICU syntax
{
  "items": "{count, plural, =0 {No items} =1 {One item} other {# items}}"
}
```

---

## RTL (Right-to-Left) Support

```typescript
// layout.tsx
export default function Layout({ children, params: { locale } }) {
  const direction = locale === 'ar' || locale === 'he' ? 'rtl' : 'ltr';
  
  return (
    <html lang={locale} dir={direction}>
      <body>{children}</body>
    </html>
  );
}

// CSS for RTL
.container {
  margin-inline-start: 1rem; /* Instead of margin-left */
  padding-inline-end: 1rem;  /* Instead of padding-right */
}
```

---

## Dynamic Route Parameters

```typescript
// app/[locale]/blog/[slug]/page.tsx
import { useTranslations } from 'next-intl';

export default function BlogPost({ params }: { params: { locale: string; slug: string } }) {
  const t = useTranslations('blog');
  
  return <article>{/* Post content */}</article>;
}

// Generate static params for all locales
export function generateStaticParams() {
  return [
    { locale: 'en', slug: 'hello-world' },
    { locale: 'es', slug: 'hola-mundo' },
  ];
}
```
